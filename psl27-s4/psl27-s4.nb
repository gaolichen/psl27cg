(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53191,       1171]
NotebookOptionsPosition[     52873,       1156]
NotebookOutlinePosition[     53207,       1171]
CellTagsIndexPosition[     53164,       1168]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
    "<<", "\"\</users/gaolichen/gitroot/psl27cg/mpackage/cgframework.m\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "<<", "\"\</users/gaolichen/gitroot/psl27cg/mpackage/psl27-generators.m\>\
\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "<<", "\"\</users/gaolichen/gitroot/psl27cg/mpackage/cyclicnumber.m\>\""}]\
, ";"}]}]}]], "Input",
 CellChangeTimes->{{3.699283753884763*^9, 3.6992837549183283`*^9}, {
  3.699457238184126*^9, 3.699457252081276*^9}, {3.699465458725263*^9, 
  3.699465465403256*^9}, {3.70406055394831*^9, 3.704060555350844*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"PSL27", " ", "Group", " ", "Info"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "Psl27", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27", "[", "KeyIrr", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<1\>\"", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<3\>\"", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<3b\>\"", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<6\>\"", ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<7\>\"", ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<8\>\"", ",", "8"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "Psl27Kronecker", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
     RowBox[{"DefaultKronecker", "[", 
      RowBox[{"Psl27", ",", "x", ",", "y"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<3\>\"", ",", "\"\<3\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"\"\<3b:-\>\"", ",", "\"\<6:+\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<3\>\"", ",", "\"\<3b\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"\"\<1\>\"", ",", "\"\<8\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<3\>\"", ",", "\"\<6\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"\"\<3b\>\"", ",", "\"\<7\>\"", ",", "\"\<8\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<3\>\"", ",", "\"\<7\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"\"\<6\>\"", ",", "\"\<7\>\"", ",", "\"\<8\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<3\>\"", ",", "\"\<8\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<3\>\"", ",", "\"\<6\>\"", ",", "\"\<7\>\"", ",", "\"\<8\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<6\>\"", ",", "\"\<6\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1:+\>\"", ",", "\"\<6:+1\>\"", ",", "\"\<6:+2\>\"", ",", 
       "\"\<8:+\>\"", ",", "\"\<7:-\>\"", ",", "\"\<8:-\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<6\>\"", ",", "\"\<7\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<3\>\"", ",", "\"\<3b\>\"", ",", "\"\<6\>\"", ",", "\"\<7:1\>\"", 
       ",", "\"\<7:2\>\"", ",", "\"\<8:1\>\"", ",", "\"\<8:2\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<6\>\"", ",", "\"\<8\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<3\>\"", ",", "\"\<3b\>\"", ",", "\"\<6:1\>\"", ",", "\"\<6:2\>\"", 
       ",", "\"\<7:1\>\"", ",", "\"\<7:2\>\"", ",", "\"\<8:1\>\"", ",", 
       "\"\<8:2\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<7\>\"", ",", "\"\<7\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1:+\>\"", ",", "\"\<6:+1\>\"", ",", "\"\<6:+2\>\"", ",", 
       "\"\<7:+\>\"", ",", "\"\<8:+\>\"", ",", "\"\<3:-\>\"", ",", 
       "\"\<3b:-\>\"", ",", "\"\<7:-\>\"", ",", "\"\<8:-\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<7\>\"", ",", "\"\<8\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<3\>\"", ",", "\"\<3b\>\"", ",", "\"\<6:1\>\"", ",", "\"\<6:2\>\"", 
       ",", "\"\<7:1\>\"", ",", "\"\<7:2\>\"", ",", "\"\<8:1\>\"", ",", 
       "\"\<8:2\>\"", ",", "\"\<8:3\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27Kronecker", "[", 
      RowBox[{"\"\<8\>\"", ",", "\"\<8\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<1:+\>\"", ",", "\"\<6:+1\>\"", ",", "\"\<6:+2\>\"", ",", 
       "\"\<7:+\>\"", ",", "\"\<8:+1\>\"", ",", "\"\<8:+2\>\"", ",", 
       "\"\<3:-\>\"", ",", "\"\<3b:-\>\"", ",", "\"\<7:-1\>\"", ",", 
       "\"\<7:-2\>\"", ",", "\"\<8:-\>\""}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27", "[", "KeyKronecker", "]"}], ":=", "Psl27Kronecker"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27", "[", "KeyConjugateIrr", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"\"\<3\>\"", ",", "\"\<3b\>\""}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"On", "[", "Assert", "]"}], "\[IndentingNewLine]", 
   RowBox[{"VerifyGroupInfo", "[", "Psl27", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"embedding", " ", "of", " ", "S4", " ", "in", " ", "Psl27"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ClearAll", "[", "Psl27ToS4", "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "KeyLargeGroup", "]"}], ":=", "Psl27"}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "KeySubGroup", "]"}], ":=", "S4Group"}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Psl27ToS4", "[", "r_", "]"}], ":=", 
    RowBox[{"DefaultEmbed", "[", 
     RowBox[{"r", ",", " ", "Psl27", ",", " ", "S4Group"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "\"\<3\>\"", "]"}], ":=", 
     RowBox[{"{", "\"\<3_2\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "\"\<3b\>\"", "]"}], ":=", 
     RowBox[{"{", "\"\<3_2\>\"", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "\"\<6\>\"", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"\"\<1_0\>\"", ",", "\"\<2\>\"", ",", "\"\<3_1\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "\"\<7\>\"", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"\"\<1_1\>\"", ",", "\"\<3_1\>\"", ",", "\"\<3_2\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "\"\<8\>\"", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"\"\<2\>\"", ",", "\"\<3_1\>\"", ",", "\"\<3_2\>\""}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Psl27ToS4", "[", "KeyTransformMatrix", "]"}], ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"\"\<3b\>\"", ",", "\"\<3_2\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]}], "}"}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<1\>\"", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<3\>\"", "]"}], ":=", 
     RowBox[{"pslA3", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<3b\>\"", "]"}], ":=", 
     RowBox[{"pslA3b", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<6\>\"", "]"}], ":=", 
     RowBox[{"pslA6", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<7\>\"", "]"}], ":=", 
     RowBox[{"pslA7", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenA", "[", "\"\<8\>\"", "]"}], ":=", 
     RowBox[{"pslA8", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<1\>\"", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{"{", "1", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<3\>\"", "]"}], ":=", 
     RowBox[{"pslB3", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<3b\>\"", "]"}], ":=", 
     RowBox[{"pslB3b", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<6\>\"", "]"}], ":=", 
     RowBox[{"pslB6", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<7\>\"", "]"}], ":=", 
     RowBox[{"pslB7", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PslGenB", "[", "\"\<8\>\"", "]"}], ":=", 
     RowBox[{"pslB8", "/.", "b7ToEt"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"On", "[", "Assert", "]"}], "\[IndentingNewLine]", 
   RowBox[{"VerifyEmbed", "[", "Psl27ToS4", "]"}], "\[IndentingNewLine]", 
   RowBox[{"BuildCGTermsAll", "[", "Psl27ToS4", "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6992756241015472`*^9, 3.699275671981982*^9}, {
   3.699293775237732*^9, 3.699293794063113*^9}, {3.699295529147513*^9, 
   3.699295552603633*^9}, {3.699317145945179*^9, 3.699317146906282*^9}, 
   3.699381427451576*^9, {3.6994573155136347`*^9, 3.699457455831664*^9}, {
   3.6994575043637457`*^9, 3.699457520447097*^9}, {3.704667981346108*^9, 
   3.70466800282685*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"DotRep", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4", ",", "y5", ",", "y6"}], 
       "}"}], ",", " ", "\"\<6\>\"", ",", "\"\<6\>\"", ",", "\"\<6:+1\>\"", 
      ",", " ", "Psl27ToS4"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"DotRep", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y1", ",", "y2", ",", "y3", ",", "y4", ",", "y5", ",", "y6"}], 
       "}"}], ",", " ", "\"\<6\>\"", ",", "\"\<6\>\"", ",", "\"\<7:-\>\"", 
      ",", " ", "Psl27ToS4"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"PslGenA", "[", "\"\<3\>\"", "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"LeftDiag", "[", "Y", "]"}], "]"}], ".", "Y", ".", 
     RowBox[{"RightDiag", "[", "Y", "]"}]}], " ", "=", " ", 
    RowBox[{"diagonal", " ", "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LeftDiag", "[", "Y_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", ",", "res", ",", "ret"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mat", " ", "=", " ", 
         RowBox[{"Y", ".", 
          RowBox[{"ConjugateTranspose", "[", "Y", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ret", " ", "=", " ", 
         RowBox[{"ConjugateTranspose", "[", 
          RowBox[{"res", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RightDiag", "[", "Y_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", ",", "res", ",", "ret"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mat", " ", "=", " ", 
         RowBox[{
          RowBox[{"ConjugateTranspose", "[", "Y", "]"}], ".", "Y"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Eigensystem", "[", "mat", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ret", " ", "=", " ", 
         RowBox[{"Transpose", "[", 
          RowBox[{"res", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "ret", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestCG", "[", 
      RowBox[{
      "r1_", ",", "r2_", ",", "r3_", ",", "embed_", ",", "op_", ",", 
       "cgList_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "rr3", ",", 
         RowBox[{"ret", "=", "True"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "cgList", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "cgList", "]"}], "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"rr3", "=", "r3"}], ",", " ", 
             RowBox[{"rr3", "=", 
              RowBox[{"SetRepMultiplicity", "[", 
               RowBox[{"r3", ",", " ", "i"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"rr3", "=", 
              RowBox[{"SetRepMultiplicity", "[", 
               RowBox[{"r3", ",", " ", "i"}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"SetCG", "[", 
            RowBox[{"r1", ",", "r2", ",", "rr3", ",", "embed", ",", 
             RowBox[{"N", "[", 
              RowBox[{
               RowBox[{"cgList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{"et", "\[Rule]", 
                 RowBox[{"Exp", "[", 
                  RowBox[{"I", "*", "2", 
                   RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"VerifyCG", "[", 
               RowBox[{
               "r1", ",", "r2", ",", "rr3", ",", "embed", ",", "op", ",", 
                "b7ToNum"}], "]"}], "\[Equal]", "False"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Print", "[", 
               RowBox[{
               "\"\<TestCG: failed for CG \>\"", " ", "<>", " ", "r1", " ", "<>",
                 " ", "\"\<*\>\"", " ", "<>", " ", "r2", " ", "<>", 
                "\"\<->\>\"", "<>", "rr3"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"ret", " ", "=", " ", "False"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"ResetCG", "[", 
            RowBox[{"r1", ",", "r2", ",", "rr3", ",", "embed"}], "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", "ret", "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SolveCGEquations", "[", "eqs_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"neqs", ",", "mat", ",", "root", ",", "i"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<rank=\>\"", ",", 
           RowBox[{"MatrixRank", "[", 
            RowBox[{"eqs", "/.", 
             RowBox[{"{", 
              RowBox[{"et", "\[Rule]", 
               RowBox[{"Exp", "[", 
                RowBox[{"I", "*", "2", "*", 
                 RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}], "]"}]}], "]"}],
          ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"neqs", " ", "=", " ", 
         RowBox[{"IndependentRows", "[", 
          RowBox[{"eqs", ",", 
           RowBox[{"Var2N", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"et", "\[Rule]", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "2", "*", 
                RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"mat", "=", 
         RowBox[{"SimplifyCN", "[", 
          RowBox[{
           RowBox[{"neqs", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "et", ",", "7"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"mat", "=", 
           RowBox[{"SimplifyCN", "[", 
            RowBox[{"eqs", ",", "et", ",", "7"}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mat", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"mat", "/.", "et4ToB7"}], "/.", "b7ToNum"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<mat=\>\"", ",", "mat"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<freeparameter=\>\"", ",", 
            RowBox[{"neqs", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"root", "=", 
         RowBox[{"SolveLinearEquation", "[", 
          RowBox[{"mat", ",", 
           RowBox[{"FreeCoefficients", "\[Rule]", 
            RowBox[{"neqs", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", 
           RowBox[{"Numeric", "\[Rule]", "True"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"root", "=", 
         RowBox[{"N2Exact", "[", "root", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<root=\>\"", ",", "root"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Return", "[", "root", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Simplify", "[", "root", "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FinalizeCG", "[", 
      RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", "cgEqs_", ",", "embed_"}], 
      "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coefsList", ",", "i", ",", "j", ",", "mat", ",", "nmat", ",", "mat2",
          ",", "evlist", ",", "cgmat", ",", "res", ",", "u", ",", "w", ",", 
         "v", ",", "diag"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coefsList", "=", 
         RowBox[{"SolveCGEquations", "[", "cgEqs", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "If", " ", "there", " ", "is", " ", "only", " ", "one", " ", "cg", 
           " ", "term"}], ",", " ", 
          RowBox[{
          "then", " ", "we", " ", "manually", " ", "set", " ", "the", " ", 
           "CG", " ", "coefficients", " ", "to", " ", "1."}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "coefsList", "]"}], "\[Equal]", "0"}], " ",
            "&&", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"embed", "[", 
              RowBox[{"r1", ",", "r2", ",", "r3", ",", "KeyCGTerms"}], "]"}], 
             "]"}], "\[Equal]", "1"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"coefsList", "=", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], ";"}]}], "\[IndentingNewLine]",
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<coefsList=\>\"", ",", "coefsList"}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TestCG", "[", 
            RowBox[{
            "r1", ",", "r2", ",", "r3", ",", "embed", ",", "PslGenB", ",", 
             RowBox[{"coefsList", "/.", "b7ToNum"}]}], "]"}], "\[Equal]", 
           "False"}], ",", " ", "\[IndentingNewLine]", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "}"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "need", " ", "to", " ", "build", " ", "authonormal", " ", 
          "basis", " ", "if", " ", "there", " ", "are", " ", "more", " ", 
          "than", " ", "one", " ", 
          RowBox[{"solutions", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "coefsList", "]"}], ">", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"mat", "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Length", "[", "coefsList", "]"}], ",", 
                  RowBox[{"Length", "[", "coefsList", "]"}]}], "}"}]}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"cgmat", "=", 
              RowBox[{"CGConjugateMat", "[", 
               RowBox[{"r1", ",", "r2", ",", "r3", ",", "embed"}], "]"}]}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mat", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
                RowBox[{
                 RowBox[{"coefsList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ".", "cgmat", ".", 
                 RowBox[{"coefsList", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", 
                 RowBox[{"Length", "[", "coefsList", "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", "coefsList", "]"}]}], "}"}]}], "]"}], 
             ";", "\[IndentingNewLine]", 
             RowBox[{"mat", "=", 
              RowBox[{"SimplifyCN", "[", 
               RowBox[{
                RowBox[{"mat", "/.", "b7ToEt"}], ",", "et", ",", "7"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"nmat", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{"N", "[", 
                RowBox[{"mat", "/.", 
                 RowBox[{"{", 
                  RowBox[{"et", "\[Rule]", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"I", "*", "2", 
                    RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}], "]"}], 
               "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<nmat=\>\"", ",", 
               RowBox[{"MatrixForm", "[", "nmat", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"u", "=", 
              RowBox[{"LeftDiag", "[", "nmat", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"diag", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "u", "]"}], ".", "nmat", ".", "u"}],
                "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"diag", "=", 
              RowBox[{"Inverse", "[", 
               RowBox[{"Sqrt", "[", "diag", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"u", "=", 
              RowBox[{"Chop", "[", 
               RowBox[{"Transpose", "[", 
                RowBox[{"u", ".", "diag"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<u=\>\"", ",", 
               RowBox[{"MatrixForm", "[", "u", "]"}], ",", 
               "\"\<,u.nmat.u^T=\>\"", ",", 
               RowBox[{"Chop", "[", 
                RowBox[{"u", ".", "nmat", ".", 
                 RowBox[{"Transpose", "[", "u", "]"}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{"\"\<res=\>\"", ",", 
               RowBox[{"Chop", "[", 
                RowBox[{"Sum", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"u", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "*", 
                    RowBox[{"coefsList", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "/.", 
                    RowBox[{"{", 
                    RowBox[{"et", "\[Rule]", " ", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"I", "*", "2", 
                    RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}], "/.", 
                   "b7ToNum"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", "u", "]"}]}], "}"}]}], "]"}], 
                "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
         "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"coefsList", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"FixCGPhase", "[", 
              RowBox[{"r1", ",", "r2", ",", "r3", ",", 
               RowBox[{"coefsList", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ",", " ", "embed"}], "]"}]}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "coefsList", "]"}]}], "}"}]}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coefsList", "=", 
         RowBox[{"OrthnormalizeCG", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3", ",", 
           RowBox[{"coefsList", "/.", "b7ToEt"}], ",", " ", "embed"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coefsList", "=", 
         RowBox[{"N2Exact", "[", 
          RowBox[{"N", "[", 
           RowBox[{"coefsList", "/.", 
            RowBox[{"{", 
             RowBox[{"et", "\[Rule]", 
              RowBox[{"Exp", "[", 
               RowBox[{"I", "*", "2", 
                RowBox[{"Pi", "/", "7"}]}], "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ToRadicals", "[", "coefsList", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"ToExp", "[", 
          RowBox[{"ToRadicals", "[", "coefsList", "]"}], "]"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CalculateCG", "[", 
      RowBox[{
      "r1_String", ",", "r2_String", ",", "r3_String", ",", "embed_", ",", 
       " ", "input_", ",", "opList_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eqs", ",", "res", ",", "i", ",", "rr3", ",", "repName", ",", 
         "repDec", ",", "m", ",", "largeG"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"largeG", "=", 
         RowBox[{"embed", "[", "KeyLargeGroup", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"GetCGMultiplicity", "[", 
          RowBox[{"largeG", ",", "r1", ",", "r2", ",", "r3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", ">", "1"}], ",", 
          RowBox[{"rr3", "=", 
           RowBox[{"SetRepMultiplicity", "[", 
            RowBox[{"r3", ",", "1"}], "]"}]}], ",", 
          RowBox[{"rr3", "=", "r3"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ResetCG", "[", 
         RowBox[{"r1", ",", "r2", ",", "rr3", ",", "embed"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<GetCG=\>\"", ",", 
            RowBox[{"GetCG", "[", 
             RowBox[{"r1", ",", "r2", ",", "rr3", ",", "embed"}], "]"}]}], 
           "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"eqs", "=", 
         RowBox[{"CgcEquations", "[", 
          RowBox[{
          "input", ",", " ", "r1", ",", "r2", ",", "rr3", ",", "embed", ",", 
           " ", "opList"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<eqs=\>\"", ",", "eqs"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"FinalizeCG", "[", 
          RowBox[{"r1", ",", "r2", ",", 
           RowBox[{"GetRepWithSym", "[", "r3", "]"}], ",", "eqs", ",", " ", 
           "embed"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<res=\>\"", ",", "res"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "res", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "res", "]"}], "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"rr3", "=", "r3"}], ",", " ", 
             RowBox[{"rr3", "=", 
              RowBox[{"SetRepMultiplicity", "[", 
               RowBox[{"r3", ",", " ", "i"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"SetCG", "[", 
            RowBox[{"r1", ",", "r2", ",", "rr3", ",", "embed", ",", 
             RowBox[{"res", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"ToExp", "[", "res", "]"}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PrintCG", "[", 
      RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", " ", "embed_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "cg", ",", "cgterms", ",", "term", ",", "row", ",", "i", ",", 
         RowBox[{"isFirst", "=", "True"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cg", "=", 
         RowBox[{"GetCG", "[", 
          RowBox[{"r1", ",", "r2", ",", "r3", ",", "Psl27ToS4"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"cgterms", "=", 
         RowBox[{"embed", "[", 
          RowBox[{"r1", ",", "r2", ",", 
           RowBox[{"GetRepWithSym", "[", "r3", "]"}], ",", "KeyCGTerms"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"row", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", " ", 
           RowBox[{"Length", "[", "cg", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SameQ", "[", 
               RowBox[{
                RowBox[{"cg", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "]"}], 
              "\[Equal]", "True"}], ",", " ", 
             RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"isFirst", "\[Equal]", " ", "False"}], " ", "&&", " ", 
              RowBox[{
               RowBox[{"StringTake", "[", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"cg", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", "InputForm"}], "]"}],
                  ",", "1"}], "]"}], "\[NotEqual]", " ", "\"\<-\>\""}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"row", ",", "\"\<+\>\""}], "]"}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"row", ",", 
             RowBox[{"cg", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"term", "=", 
            RowBox[{"cgterms", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"row", ",", " ", 
             RowBox[{"\"\<(\>\"", "<>", 
              RowBox[{"term", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<*\>\"", "<>", 
              RowBox[{"term", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "<>", "\"\<->\>\"", "<>", 
              RowBox[{"term", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<)\>\""}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "term", "]"}], "\[Equal]", "4"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"term", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"row", ",", "\"\<_s\>\""}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"row", ",", "\"\<_a\>\""}], "]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"isFirst", "=", "False"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"Row", "[", "row", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ClaculateAndPrintPslCG", "[", 
      RowBox[{"r1_", ",", "r2_", ",", "r3_", ",", " ", "input_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"m", ",", "i", ",", "rr3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"CalculateCG", "[", 
         RowBox[{
         "r1", ",", "r2", ",", "r3", ",", "Psl27ToS4", ",", "input", ",", 
          RowBox[{"{", "PslGenB", "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"m", "=", 
         RowBox[{"GetCGMultiplicity", "[", 
          RowBox[{"Psl27", ",", "r1", ",", "r2", ",", "r3"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"m", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PrintCG", "[", 
           RowBox[{"r1", ",", "r2", ",", "r3", ",", "Psl27ToS4"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "\[LessEqual]", " ", "m"}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rr3", "=", 
               RowBox[{"SetRepMultiplicity", "[", 
                RowBox[{"r3", ",", " ", "i"}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"PrintCG", "[", 
               RowBox[{"r1", ",", "r2", ",", "rr3", ",", "Psl27ToS4"}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.699275710363783*^9, 3.6992757108427467`*^9}, {
   3.699289792423512*^9, 3.699289795964517*^9}, {3.699290438790338*^9, 
   3.6992904754628773`*^9}, {3.699294141327721*^9, 3.699294166466729*^9}, {
   3.699294312386939*^9, 3.699294327295072*^9}, {3.6992951503112*^9, 
   3.699295190495687*^9}, {3.699295251656419*^9, 3.699295258631309*^9}, {
   3.699295623710141*^9, 3.699295638244405*^9}, {3.699295743172174*^9, 
   3.6992957433990602`*^9}, {3.699311793975314*^9, 3.6993118098790197`*^9}, {
   3.6993171430852423`*^9, 3.699317229745678*^9}, {3.69931785131654*^9, 
   3.699317889870021*^9}, {3.699379783998238*^9, 3.6993797846001263`*^9}, {
   3.6993814374671707`*^9, 3.699381439687572*^9}, {3.699443850825509*^9, 
   3.699443859169553*^9}, {3.69945752454878*^9, 3.69945752752289*^9}, {
   3.6994600474787827`*^9, 3.6994601709600897`*^9}, {3.69946021391938*^9, 
   3.6994602158420877`*^9}, {3.699460316537693*^9, 3.6994603448213*^9}, 
   3.6994603871355457`*^9, {3.699460419542924*^9, 3.699460423481539*^9}, {
   3.6994605059290524`*^9, 3.699460521216123*^9}, {3.699460564816635*^9, 
   3.699460603175324*^9}, {3.6994637994470778`*^9, 3.6994638958645687`*^9}, {
   3.699463932423443*^9, 3.6994639515715237`*^9}, 3.6994640122521687`*^9, {
   3.699464612724221*^9, 3.699464616408691*^9}, {3.699465055300271*^9, 
   3.699465064584675*^9}, 3.6994652883631697`*^9, {3.6994654117910748`*^9, 
   3.6994654357539873`*^9}, {3.699465473112391*^9, 3.699465475192864*^9}, {
   3.699465536961707*^9, 3.6994655650691853`*^9}, {3.6994658241702538`*^9, 
   3.69946582845121*^9}, {3.699465980297626*^9, 3.6994659994886303`*^9}, {
   3.699467053751512*^9, 3.699467074398842*^9}, {3.699467192014131*^9, 
   3.69946728244702*^9}, {3.699467314646819*^9, 3.69946736553533*^9}, {
   3.699467396648003*^9, 3.6994674635772448`*^9}, {3.6994675489176197`*^9, 
   3.6994675700150642`*^9}, 3.69946782689421*^9, {3.699467904407652*^9, 
   3.699467996808731*^9}, {3.6994680309998913`*^9, 3.699468052505946*^9}, {
   3.699468312325001*^9, 3.699468316416329*^9}, {3.699478314484228*^9, 
   3.699478335662835*^9}, {3.6994783766578627`*^9, 3.6994783847164173`*^9}, {
   3.699478450097856*^9, 3.699478468081315*^9}, {3.699478908401792*^9, 
   3.69947895298779*^9}, {3.699478991259431*^9, 3.69947905229021*^9}, {
   3.699479083587902*^9, 3.699479134772047*^9}, {3.69947922203202*^9, 
   3.699479222470079*^9}, {3.699479450613394*^9, 3.69947949674664*^9}, {
   3.69947957255418*^9, 3.69947960426019*^9}, {3.6994796450889177`*^9, 
   3.699479660760675*^9}, {3.699479716730768*^9, 3.699479763766575*^9}, {
   3.699480889117014*^9, 3.6994809525607347`*^9}, 3.699480997241856*^9, {
   3.699481206342737*^9, 3.6994812364062347`*^9}, {3.6996218696856833`*^9, 
   3.699621883095337*^9}, {3.699621996940844*^9, 3.699622044899839*^9}, {
   3.699622108379649*^9, 3.699622185875781*^9}, {3.699630301456621*^9, 
   3.699630348360775*^9}, {3.699630394360592*^9, 3.6996304311373034`*^9}, {
   3.6996340204179163`*^9, 3.699634101849671*^9}, {3.699634276415914*^9, 
   3.699634308512927*^9}, {3.699634360704731*^9, 3.699634499721562*^9}, {
   3.699634668104158*^9, 3.699634674471264*^9}, {3.699634893856215*^9, 
   3.6996349239063807`*^9}, {3.699634954987163*^9, 3.699634973585937*^9}, {
   3.699635004230947*^9, 3.6996350220401382`*^9}, {3.6996350649143476`*^9, 
   3.699635103441896*^9}, {3.699658783705758*^9, 3.699658784073401*^9}, {
   3.699658936767811*^9, 3.6996589504547997`*^9}, {3.699660457642671*^9, 
   3.6996605036833467`*^9}, {3.6996605660354652`*^9, 3.699660632993685*^9}, {
   3.69966067813433*^9, 3.6996606987204247`*^9}, 3.699660876128587*^9, {
   3.699661156772148*^9, 3.69966118442297*^9}, 3.699661214598723*^9, {
   3.699661728671628*^9, 3.699661732719089*^9}, {3.7008439111479483`*^9, 
   3.7008439338745728`*^9}, {3.700845251717358*^9, 3.70084529341497*^9}, {
   3.700845550213243*^9, 3.7008455567494917`*^9}, {3.700872263052188*^9, 
   3.700872263500884*^9}, 3.7008728298710203`*^9, 3.703856456630376*^9, {
   3.703856600564979*^9, 3.703856600844241*^9}, {3.703856717461563*^9, 
   3.703856718916087*^9}, {3.7038569171339293`*^9, 3.703857205454213*^9}, {
   3.703857322423995*^9, 3.703857375291181*^9}, {3.703857445440423*^9, 
   3.703857470781468*^9}, {3.703857503232478*^9, 3.703857551492146*^9}, {
   3.703857582092235*^9, 3.703857592224414*^9}, {3.70385770903763*^9, 
   3.703857835899836*^9}, {3.703857879300062*^9, 3.703857899065453*^9}, {
   3.703858056276018*^9, 3.703858056755481*^9}, {3.703858222917889*^9, 
   3.7038583671548023`*^9}, {3.703858845038005*^9, 3.703858846542186*^9}, {
   3.703858888620983*^9, 3.7038589066389303`*^9}, {3.703859187008939*^9, 
   3.703859316771487*^9}, {3.703859421395596*^9, 3.7038594617003803`*^9}, {
   3.703859646357128*^9, 3.7038598608056297`*^9}, {3.703859923100792*^9, 
   3.703859938864545*^9}, {3.703860003867354*^9, 3.703860040147909*^9}, {
   3.7038600711584682`*^9, 3.703860138585615*^9}, {3.703860738943194*^9, 
   3.703860740205971*^9}, {3.703860834932963*^9, 3.703860905355858*^9}, {
   3.703860949461453*^9, 3.7038610248829193`*^9}, {3.703861127255023*^9, 
   3.703861176847371*^9}, {3.703861226852456*^9, 3.703861274133904*^9}, {
   3.7038623192383623`*^9, 3.703862381011441*^9}, {3.703862491225335*^9, 
   3.703862544233561*^9}, {3.7038626332309437`*^9, 3.703862780200399*^9}, {
   3.703862839218554*^9, 3.703862999836195*^9}, {3.7038630873577623`*^9, 
   3.7038631767006683`*^9}, {3.703863247241137*^9, 3.703863256126473*^9}, {
   3.703864197288252*^9, 3.703864218471693*^9}, {3.7038644641102543`*^9, 
   3.7038646442061033`*^9}, 3.703864842801045*^9, {3.703866052393178*^9, 
   3.703866110307744*^9}, {3.703866234371408*^9, 3.703866273975192*^9}, {
   3.703866306211619*^9, 3.703866400852663*^9}, {3.703866431940048*^9, 
   3.7038664831169767`*^9}, {3.703867067320444*^9, 3.703867253312236*^9}, {
   3.703868318338085*^9, 3.70386833099034*^9}, {3.703869763624189*^9, 
   3.703869920453533*^9}, {3.703869966027218*^9, 3.703870053323741*^9}, {
   3.7038701106619873`*^9, 3.70387011755466*^9}, {3.7038705389680967`*^9, 
   3.703870548144641*^9}, {3.703870770000955*^9, 3.703870777962373*^9}, {
   3.703870886258309*^9, 3.7038708901079683`*^9}, {3.703871014449876*^9, 
   3.703871019256207*^9}, {3.703887902212626*^9, 3.7038879089619513`*^9}, {
   3.703887940095419*^9, 3.7038880203109093`*^9}, {3.7038896832702007`*^9, 
   3.7038897583963737`*^9}, {3.703891479359522*^9, 3.70389149016908*^9}, {
   3.703891523072988*^9, 3.7038916050883636`*^9}, {3.703891656307033*^9, 
   3.703891691660522*^9}, {3.703891792483871*^9, 3.703891801796386*^9}, {
   3.703891844387599*^9, 3.703891936818738*^9}, {3.703892163376153*^9, 
   3.703892179857695*^9}, {3.703892250275539*^9, 3.703892309253934*^9}, {
   3.703892525565933*^9, 3.703892542781475*^9}, 3.70389261215415*^9, {
   3.7038927143827553`*^9, 3.7038927312325*^9}, {3.7038927705996237`*^9, 
   3.703892829614624*^9}, 3.703892914912446*^9, 3.703893021051313*^9, {
   3.703893073452985*^9, 3.703893078266712*^9}, 3.703893169198656*^9, {
   3.703893255071594*^9, 3.703893363050894*^9}, {3.703893410791642*^9, 
   3.703893412814673*^9}, {3.703893527448628*^9, 3.70389362950421*^9}, {
   3.703893680372093*^9, 3.703893766670326*^9}, {3.703896364177833*^9, 
   3.7038964203267183`*^9}, {3.70389646832367*^9, 3.7038964809778557`*^9}, {
   3.7038965110705976`*^9, 3.703896713864457*^9}, {3.703957646491563*^9, 
   3.703957723488414*^9}, {3.703958827595683*^9, 3.703958832154944*^9}, {
   3.703975678562766*^9, 3.703975687090918*^9}, 3.703976308037858*^9, {
   3.703976354118825*^9, 3.703976364273654*^9}, 3.70397723939546*^9, {
   3.703979103230185*^9, 3.703979123831615*^9}, {3.703979168884688*^9, 
   3.703979178338173*^9}, {3.703979212914165*^9, 3.703979240885401*^9}, {
   3.703982726529079*^9, 3.703982747687855*^9}, {3.703982971570932*^9, 
   3.7039831123619337`*^9}, {3.703983188938756*^9, 3.703983216278852*^9}, {
   3.704025134533649*^9, 3.704025158060543*^9}, {3.704025218939699*^9, 
   3.704025231553533*^9}, 3.704025376125959*^9, {3.704025545175128*^9, 
   3.7040255778630667`*^9}, {3.704032387195232*^9, 3.704032399995117*^9}, {
   3.704032498805026*^9, 3.7040325381773767`*^9}, 3.704032593910213*^9, {
   3.704046536181551*^9, 3.7040465815011463`*^9}, {3.70404668342019*^9, 
   3.704046712983191*^9}, 3.704046746427178*^9, {3.704059926354776*^9, 
   3.704059940782493*^9}, {3.7040600109915943`*^9, 3.7040600236532183`*^9}, {
   3.704060097241007*^9, 3.704060105576599*^9}, {3.70406146051997*^9, 
   3.704061476134309*^9}, {3.7044089514432364`*^9, 3.704408964771286*^9}, {
   3.7044089972516613`*^9, 3.704409251486396*^9}, {3.7044093551919518`*^9, 
   3.7044093729496107`*^9}, {3.704409606041423*^9, 3.704409722612918*^9}, {
   3.70440978441227*^9, 3.7044097856255217`*^9}, {3.7044103234338627`*^9, 
   3.7044103421959867`*^9}, {3.704414939492751*^9, 3.704414994262355*^9}, {
   3.7044151569374943`*^9, 3.7044152320597258`*^9}, {3.70441529586052*^9, 
   3.704415298698329*^9}, {3.704415343030216*^9, 3.704415373415617*^9}, {
   3.704455538808195*^9, 3.704455570232955*^9}, {3.704455627173283*^9, 
   3.704455733653401*^9}, {3.7044563959448013`*^9, 3.704456457081849*^9}, {
   3.704456529178866*^9, 3.704456616446612*^9}, {3.704456661323303*^9, 
   3.7044566704850187`*^9}, {3.7044567078007174`*^9, 3.704456723836993*^9}, {
   3.7044567691399803`*^9, 3.704456801598127*^9}, {3.70445759851644*^9, 
   3.704457776031451*^9}, 3.704457838696178*^9, {3.704457894962718*^9, 
   3.7044579143785963`*^9}, {3.704458001354858*^9, 3.704458165655149*^9}, {
   3.70445820799161*^9, 3.704458226300115*^9}, {3.7044582736945066`*^9, 
   3.704458277675151*^9}, {3.7044586275528917`*^9, 3.704458630014673*^9}, {
   3.7044587375917883`*^9, 3.704458742385048*^9}, {3.7044587800044737`*^9, 
   3.70445886350282*^9}, {3.704458972351727*^9, 3.7044589814427156`*^9}, {
   3.704459263010475*^9, 3.704459329483412*^9}, {3.704459426470572*^9, 
   3.7044594335937767`*^9}, {3.704459486828863*^9, 3.7044594910455103`*^9}, {
   3.7044595294859667`*^9, 3.7044595395794973`*^9}, {3.704461976782786*^9, 
   3.704462078263668*^9}, {3.70446225023298*^9, 3.704462295491831*^9}, {
   3.704462336890842*^9, 3.704462379755519*^9}, {3.704462429664742*^9, 
   3.7044624646960793`*^9}, {3.704462524388238*^9, 3.7044625249320602`*^9}, {
   3.7044677754427967`*^9, 3.70446790236584*^9}, {3.704467958685122*^9, 
   3.70446796682362*^9}, {3.7044681995581703`*^9, 3.704468288706461*^9}, {
   3.704468382835618*^9, 3.704468425373295*^9}, {3.7044684604333878`*^9, 
   3.70446849202087*^9}, {3.704468855914015*^9, 3.704468878968857*^9}, {
   3.7044915547306843`*^9, 3.704491754471488*^9}, {3.704491790485508*^9, 
   3.70449184581986*^9}, {3.704491929166539*^9, 3.704491965445635*^9}, {
   3.70449199789606*^9, 3.7044919979832993`*^9}, {3.7044920940077953`*^9, 
   3.704492118952264*^9}, {3.704492189248609*^9, 3.704492218129622*^9}, {
   3.704492249766358*^9, 3.704492346470213*^9}, 3.704492408310266*^9, {
   3.704493171600424*^9, 3.7044931731682777`*^9}, {3.7045418640906563`*^9, 
   3.704541933530384*^9}, {3.704541963895236*^9, 3.7045419671793118`*^9}, {
   3.70454227025028*^9, 3.704542373116509*^9}, {3.704543010296137*^9, 
   3.7045430186987953`*^9}, {3.704550113870908*^9, 3.704550124911087*^9}, {
   3.704553033749043*^9, 3.704553038961553*^9}, {3.7045530890791693`*^9, 
   3.704553097963378*^9}, {3.70455315683255*^9, 3.704553195129055*^9}, {
   3.704553278570416*^9, 3.704553281089533*^9}, {3.704560006354557*^9, 
   3.7045600243462963`*^9}, {3.7045604349037123`*^9, 
   3.7045604611344757`*^9}, {3.704584857311475*^9, 3.704584857518236*^9}, {
   3.704585215090012*^9, 3.704585247703126*^9}, {3.7045853060712976`*^9, 
   3.704585333008926*^9}, {3.704585375840233*^9, 3.704585407402829*^9}, {
   3.7045854379858093`*^9, 3.704585472771675*^9}, 3.704585550874927*^9, {
   3.704585661146224*^9, 3.7045856659630632`*^9}, {3.7046424931329803`*^9, 
   3.70464255500163*^9}, {3.704643205959831*^9, 3.704643211581586*^9}, 
   3.704643301056547*^9, {3.704643624489298*^9, 3.7046436972084217`*^9}, {
   3.7046437399908543`*^9, 3.704643742222365*^9}, {3.704644309717312*^9, 
   3.70464438772792*^9}, {3.704644475985262*^9, 3.7046448103456717`*^9}, {
   3.7046448718584538`*^9, 3.704644892338612*^9}, {3.704644943027063*^9, 
   3.7046453369223833`*^9}, {3.704645377898611*^9, 3.704645380685096*^9}, {
   3.704645465533134*^9, 3.704645472714716*^9}, {3.704645793371765*^9, 
   3.7046457950206423`*^9}, 3.704647774951343*^9, 3.7046478176766033`*^9, {
   3.704647871625238*^9, 3.7046478866727*^9}, {3.704648002180179*^9, 
   3.704648005561088*^9}, {3.704648052089973*^9, 3.70464809374575*^9}, {
   3.704648125215652*^9, 3.70464813187939*^9}, {3.704649010943413*^9, 
   3.704649072423231*^9}, {3.704649246893755*^9, 3.7046492530020933`*^9}, {
   3.704649287792659*^9, 3.704649308732481*^9}, 3.704649410635747*^9, {
   3.704739912070517*^9, 3.704739939922205*^9}, {3.704739970708055*^9, 
   3.704739996372101*^9}, {3.7047400938065033`*^9, 3.704740102000759*^9}, 
   3.7047401405963717`*^9, {3.7047401954158154`*^9, 3.704740208796123*^9}, {
   3.704740285989683*^9, 3.704740304845285*^9}, {3.704740564314636*^9, 
   3.704740565392036*^9}, {3.704741311337983*^9, 3.7047413491384478`*^9}, {
   3.704751453844964*^9, 3.7047514957023973`*^9}, {3.7047516329961357`*^9, 
   3.704751664044072*^9}, {3.704751705669238*^9, 3.704751708674697*^9}, {
   3.704753696944269*^9, 3.704753757038272*^9}, 3.704760290339923*^9, 
   3.704968989122683*^9, 3.7049690943485937`*^9, {3.704969228020729*^9, 
   3.704969269182582*^9}, {3.70497034379391*^9, 3.704970373927311*^9}, 
   3.704973606172768*^9, 3.704979154703808*^9}]
},
WindowSize->{1278, 947},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.1 for Linux x86 (64-bit) (March 23, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 678, 17, 99, "Input"],
Cell[1239, 39, 10140, 264, 1265, "Input"],
Cell[11382, 305, 41487, 849, 3300, "Input"]
}
]
*)

(* End of internal cache information *)
